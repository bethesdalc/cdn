!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.KendoDataQuery=r():e.KendoDataQuery=r()}(this,function(){return function(e){function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}var t={};return r.m=e,r.c=t,r.p="",r(0)}([function(e,r,t){"use strict";var n=t(1);r.isCompositeFilterDescriptor=n.isCompositeFilterDescriptor;var i=t(3);r.toODataString=i.toODataString;var o=t(7);r.toDataSourceRequestString=o.toDataSourceRequestString;var u=t(9);r.translateDataSourceResultGroups=u.translateDataSourceResultGroups,r.translateAggregateResults=u.translateAggregateResults;var s=t(10);r.orderBy=s.orderBy,r.process=s.process,r.distinct=s.distinct;var a=t(8);r.expr=a.expr,r.getter=a.getter;var c=t(15);r.filterBy=c.filterBy,r.compileFilter=c.compileFilter;var f=t(12);r.groupBy=f.groupBy;var l=t(11);r.composeSortDescriptors=l.composeSortDescriptors;var g=t(15);r.filterExpr=g.filterExpr;var p=t(16);r.normalizeFilters=p.normalizeFilters;var d=t(12);r.normalizeGroups=d.normalizeGroups;var v=t(14);r.aggregateBy=v.aggregateBy},function(e,r,t){"use strict";var n=t(2);r.isCompositeFilterDescriptor=function(e){return n.isPresent(e.filters)}},function(e,r){"use strict";r.isPresent=function(e){return null!==e&&void 0!==e},r.isBlank=function(e){return null===e||void 0===e},r.isArray=function(e){return Array.isArray(e)},r.isFunction=function(e){return"function"==typeof e},r.isString=function(e){return"string"==typeof e},r.isTruthy=function(e){return!!e},r.isNullOrEmptyString=function(e){return r.isBlank(e)||0===e.trim().length},r.isNotNullOrEmptyString=function(e){return!r.isNullOrEmptyString(e)},r.isNumeric=function(e){return!isNaN(e-parseFloat(e))},r.isDate=function(e){return e&&e.getTime}},function(e,r,t){"use strict";var n=t(2),i=t(4),o=function(e){var r=e.filter(function(e){return n.isPresent(e.dir)}).map(function(e){var r=e.field.replace(/\./g,"/");return"desc"===e.dir?r+" desc":r}).join(",");return r?"$orderby="+r:r},u=function(e,r){return{filter:i.serializeFilter(r.filter||{}),skip:"$skip="+r.skip,sort:o(r.sort||[]),take:"$top="+r.take}[e]};r.toODataString=function(e){return Object.keys(e).map(function(r){return u(r,e)}).filter(n.isNotNullOrEmptyString).join("&")}},function(e,r,t){"use strict";var n=t(1),i=t(5),o=t(6),u=function(e){return function(r){var t=r.field,n=r.value;return e+"("+t+","+n+")"}},s=function(e){return function(r){var t=r.field,n=r.value;return t+" "+e+" "+n}},a=function(e){return i.compose(e,o.quote,o.toLower,o.normalizeField)},c=function(e){return a(u(e))},f=function(e){return a(s(e))},l=function(e){return i.compose(s(e),o.normalizeField)},g=function(e){return i.compose(s(e),o.normalizeField,o.formatDate)},p=function(e){return i.either(o.isDateValue,g(e),l(e))},d=function(e){return i.either(o.isStringValue,f(e),p(e))},v=function(e){return e+" eq -1"},m={contains:c("contains"),doesnotcontain:i.compose(v,c("indexof")),endswith:c("endswith"),eq:d("eq"),gt:d("gt"),gte:d("ge"),isempty:function(e){var r=e.field;return r+" eq ''"},isnotempty:function(e){var r=e.field;return r+" ne ''"},isnotnull:function(e){var r=e.field;return r+" ne null"},isnull:function(e){var r=e.field;return r+" eq null"},lt:d("lt"),lte:d("le"),neq:d("ne"),startswith:c("startswith")},h=function(e){return" "+e.logic+" "},y=function(e){return m[e.operator](e)},x=o.serializeFilters(function(e){return i.either(n.isCompositeFilterDescriptor,x,y)(e)},h);r.serializeFilter=function(e){return e.filters&&e.filters.length?"$filter="+x(e):""}},function(e,r){"use strict";r.either=function(e,r,t){return function(n){return e(n)?r(n):t(n)}},r.compose=function(){for(var e=[],r=0;r<arguments.length;r++)e[r-0]=arguments[r];return function(r){return e.reduceRight(function(e,r){return r(e)},r)}}},function(e,r,t){"use strict";var n=t(2);r.wrapIf=function(e){return function(r){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e()?""+r[0]+t[0]+r[1]:t[0]}},r.toUTC=function(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))},r.quote=function(e){var r=e.field,t=e.value,n=e.ignoreCase,i=e.operator;return{value:"'"+t.replace(/'/g,"''")+"'",field:r,ignoreCase:n,operator:i}},r.formatDate=function(e){var t=e.field,n=e.value,i=e.ignoreCase,o=e.operator;return{value:JSON.stringify(r.toUTC(n)).replace(/"/g,""),field:t,ignoreCase:i,operator:o}},r.toLower=function(e){var t=e.field,n=e.value,i=e.ignoreCase,o=e.operator;return{field:(u=["tolower(",")"],u.raw=["tolower(",")"],r.wrapIf(function(){return i})(u,t)),value:n,ignoreCase:i,operator:o};var u},r.normalizeField=function(e){var r=e.field,t=e.value,n=e.ignoreCase,i=e.operator;return{value:t,field:r.replace(/\./g,"/"),ignoreCase:n,operator:i}},r.isStringValue=function(e){return n.isString(e.value)},r.isDateValue=function(e){return n.isDate(e.value)},r.serializeFilters=function(e,t){return function(n){var i=r.wrapIf(function(){return n.filters.length>1});return o=["(",")"],o.raw=["(",")"],i(o,n.filters.map(e).join(t(n)));var o}}},function(e,r,t){"use strict";var n=t(1),i=t(2),o=t(8),u=t(5),s=t(6),a=function(e){return function(r){return e+"="+r}},c=function(){return""},f=function(e){return i.isPresent(e)&&i.isArray(e)&&e.length>0},l=function(e){return function(r){return i.isPresent(e(r))}},g=function(e){return function(r){return f(e(r))}},p=function(e,r){return u.either(e,r,c)},d=function(e){var r=e.skip,t=e.take;return Math.floor((r||0)/t)+1},v=function(e,r){return function(t){return e(t).map(r).join("~")}},m=function(e){var r=e.field,t=e.dir,n=void 0===t?"asc":t;return r+"-"+n},h=function(e){var r=e.field,t=e.aggregate;return r+"-"+t},y=o.getter("take"),x=o.getter("aggregates"),D=o.getter("skip"),S=o.getter("group"),q=o.getter("sort",!0),C=v(q,m),F=v(S,m),O=v(x,h),_=function(e){return function(r){return r.slice(0,r.indexOf(e))}},b=function(e){return u.compose.apply(void 0,e.map(function(e){var r=e[0],t=e[1];return function(e){return e.replace(new RegExp(r,"g"),t)}}))},N=b([['"',""],[":","-"]]),k=_("."),w=function(e){var r=e.field,t=e.value,n=e.ignoreCase,i=e.operator;return{value:k(N(JSON.stringify(s.toUTC(t)))),field:r,ignoreCase:n,operator:i}},E=function(e){return Object.assign({},e,{sort:(q(e)||[]).filter(function(e){var r=e.dir;return i.isNotNullOrEmptyString(r)})})},T=u.compose(a("page"),d),B=u.compose(a("pageSize"),y),z=u.compose(a("group"),F),j=u.compose(a("sort"),C),P=u.compose(a("aggregate"),O),I=p(l(D),T),A=p(l(y),B),$=p(g(S),z),R=p(l(x),P),L=u.compose(p(g(q),j),E),G=function(e){var r=e.field;return i.isNotNullOrEmptyString(r)},V=function(e){var r=e.field,t=e.operator,n=e.value;return r+"~"+t+"~"+n},M=u.either(s.isDateValue,u.compose(V,w),V),U=p(G,u.either(s.isStringValue,u.compose(V,s.quote),M)),K=function(e){var r=e.logic;return"~"+r+"~"},Y=s.serializeFilters(function(e){return u.either(n.isCompositeFilterDescriptor,Y,U)(e)},K),H=function(e){var r=e.filter;if(r&&r.filters){var t=Y(r);if(t.length)return"filter="+t}return""},J=function(e){return function(r){return{aggregates:R(e),filter:H(e),group:$(e),skip:I(e),sort:L(e),take:A(e)}[r]}};r.toDataSourceRequestString=function(e){return Object.keys(e).map(J(e)).filter(i.isNotNullOrEmptyString).join("&")}},function(e,r,t){"use strict";var n=t(2),i=["",""],o=function(e,r){return[e[0]+r[0],e[1]+r[1]]},u=function(e){return!n.isNullOrEmptyString(e)},s=function(e,r,t){var n="(",i=e.indexOf("[");return i===-1?e="."+e:i>0&&(n+="(",e="."+e.substring(0,i)+" || {})"+e.substring(i)),e+=r<t-1?" || {})":")",[n,e]},a=function(e,r){return e.filter(u).reduce(function(e,r,t,n){return o(e,s(r,t,n.length))},i).join(r)},c={};r.expr=function(e,r,t){return void 0===e&&(e=""),void 0===r&&(r=!1),void 0===t&&(t="d"),e&&"["!==e.charAt(0)&&(e="."+e),r?(e=e.replace(/"([^.]*)\.([^"]*)"/g,'"$1_$DOT$_$2"'),e=e.replace(/'([^.]*)\.([^']*)'/g,"'$1_$DOT$_$2'"),e=a(e.split("."),t),e=e.replace(/_\$DOT\$_/g,".")):e=t+e,e},r.getter=function(e,t){var n=e+t;return c[n]=c[n]||new Function("d","return "+r.expr(e,t))}},function(e,r,t){"use strict";var n=t(2),i=t(5),o=function(e,r,t){return r[e]=t,r},u=function(e){return function(r){return Object.keys(r).reduce(e.bind(null,r),{})}},s=u(function(e,r,t){return o(t.toLowerCase(),r,e[t])}),a=u(function(e,r,t){return o(t,r,s(e[t]))}),c=function(e,r){return n.isPresent(e)?e:r},f=function(e){return{aggregates:e.Aggregates||e.aggregates,field:e.Member||e.member||e.field,hasSubgroups:e.HasSubgroups||e.hasSubgroups||!1,items:e.Items||e.items,value:c(e.Key,c(e.key,e.value))}},l=i.compose(function(e){var r=e.field,t=e.hasSubgroups,n=e.value,i=e.aggregates,o=e.items;return{aggregates:a(i),field:r,items:t?o.map(l):o,value:n}},f);r.translateDataSourceResultGroups=function(e){return e.map(l)},r.translateAggregateResults=function(e){return(e||[]).reduce(function(e,r){return o(r.Member,e,o(r.AggregateMethodName.toLowerCase(),e[r.Member]||{},r.Value))},{})}},function(e,r,t){"use strict";var n=t(2),i=t(11),o=t(12),u=t(16),s=t(15),a=t(13),c=t(8),f=t(5);r.orderBy=function(e,r){if(r.some(function(e){return n.isPresent(e.dir)})){e=e.slice(0);var t=i.composeSortDescriptors(r);e.sort(t)}return e};var l=function(e,r){return e===r},g=function(e){if(n.isString(e)){var r=c.getter(e);e=function(e,t){return r(e)===r(t)}}return e},p=function(e,r){return e.filter(function(e,t,n){return n.findIndex(r.bind(null,e))===t})};r.distinct=function(e,r){return void 0===r&&(r=l),p(e,g(r))},r.count=function(e,r){for(var t=0,n=0,i=e.length;n<i;n++)r(e[n])&&t++;return t},r.limit=function(e,r){return r?e.filter(r):e},r.process=function(e,t){var i=t.skip,c=t.take,l=t.filter,g=t.sort,p=t.group,d=o.normalizeGroups(p||[]).concat(g||[]);d.length&&(e=r.orderBy(e,d));var v=n.isPresent(l)&&a.filter.length,m=n.isPresent(p)&&p.length;if(!v&&!m)return{data:c?e.slice(i,i+c):e,total:e.length};var h,y,x=[];if(v?(y=s.compileFilter(u.normalizeFilters(l)),h=r.count(e,y),x.push(a.filter(y))):h=e.length,n.isPresent(i)&&n.isPresent(c)&&(x.push(a.skip(i)),x.push(a.take(c))),x.length){var D=f.compose.apply(void 0,x),S=m?o.groupBy(e,p,D,r.limit(e,y)):a.exec(D(a.concat),[],e);return{data:S,total:h}}return{data:m?o.groupBy(e,p):e,total:h}}},function(e,r,t){"use strict";var n=t(2),i=t(8),o=function(e,r){return n.isBlank(e)?e===r?0:-1:n.isBlank(r)?1:e.localeCompare?e.localeCompare(r):e>r?1:e<r?-1:0},u=function(e,r){return o(r,e)},s=function(e){var r=i.getter(e.field);return function(t,n){return("asc"===e.dir?o:u)(r(t),r(n))}},a=function(e,r){return 0};r.composeSortDescriptors=function(e){return e.filter(function(e){return n.isPresent(e.dir)}).map(function(e){return s(e)}).reduce(function(e,r){return function(t,n){return e(t,n)||r(t,n)}},a)}},function(e,r,t){"use strict";var n=t(13),i=t(2),o=t(14),u=t(15);r.normalizeGroups=function(e){return e=i.isArray(e)?e:[e],e.map(function(e){return Object.assign({dir:"asc"},e)})};var s=n.map(function(e){return e});r.groupBy=function(e,t,a,c){if(void 0===t&&(t=[]),void 0===a&&(a=s),void 0===c&&(c=e),t=r.normalizeGroups(t),!t.length)return e;var f=t[0],l={},g=n.exec(a(n.groupCombinator(f.field)),l,e),p=[];return Object.keys(g).forEach(function(e){Object.keys(g[e]).forEach(function(n){var a=g[e][n],l={},d=c;i.isPresent(f.aggregates)&&(d=u.filterBy(c,{field:f.field,ignoreCase:!1,operator:"eq",value:a.value}),l=o.aggregateBy(d,f.aggregates)),p[a.__position]={aggregates:l,field:e,items:t.length>1?r.groupBy(a.items,t.slice(1),s,d):a.items,value:a.value}})}),p}},function(e,r,t){"use strict";var n=t(2),i=t(8),o=function(e){return e=n.isPresent(e)&&e.getTime?e.getTime():e,e+""};r.groupCombinator=function(e){var r=i.getter(e,!0),t=0;return function(n,i){n[e]=n[e]||{};var u=r(i),s=o(u),a=n[e][s]||{__position:t++,aggregates:{},items:[],value:u};return a.items.push(i),n[e][s]=a,n}},r.expandAggregates=function(e){return void 0===e&&(e={}),Object.keys(e).forEach(function(r){var t=e[r];Object.keys(t).forEach(function(e){t[e]=t[e].result()})}),e};var u=function(e){return{average:function(){var e=0,r=0;return{calc:function(t){n.isNumeric(t)?(e+=t,r++):e=t},result:function(){return n.isNumeric(e)?e/r:e}}},count:function(){var e=0;return{calc:function(){return e++},result:function(){return e}}},max:function(){var e=Number.NEGATIVE_INFINITY;return{calc:function(r){e=n.isNumeric(e)||n.isDate(e)?e:r,e<r&&(n.isNumeric(r)||n.isDate(r))&&(e=r)},result:function(){return e}}},min:function(){var e=Number.POSITIVE_INFINITY;return{calc:function(r){e=n.isNumeric(e)||n.isDate(e)?e:r,e>r&&(n.isNumeric(r)||n.isDate(r))&&(e=r)},result:function(){return e}}},sum:function(){var e=0;return{calc:function(r){return e+=r},result:function(){return e}}}}[e]()};r.aggregatesCombinator=function(e){var r=e.map(function(e){var r=i.getter(e.field,!0),t=(e.aggregate||"").toLowerCase(),n=i.getter(t,!0);return function(i,o){var s=r(i)||{},a=n(s)||u(t);return a.calc(r(o)),s[e.aggregate]=a,i[e.field]=s,i}});return function(e,t){return r.reduce(function(e,r){return r(e,t)},e)}},r.concat=function(e,r){return e.push(r),e},r.map=function(e){return function(r){return function(t,n,i){return r(t,e(n,i))}}},r.filter=function(e){return function(r){return function(t,n){return e(n)?r(t,n):t}}},r.isTransformerResult=function(e){return n.isPresent(e.__value)};var s=function(e){return r.isTransformerResult(e)?e:{__value:e,reduced:!0}};r.take=function(e){return function(r){return function(t,n){return e-- >0?r(t,n):s(t)}}},r.takeWhile=function(e){return function(r){return function(t,n){return e(n)?r(t,n):s(t)}}},r.skip=function(e){return function(r){return function(t,n){return e--<=0?r(t,n):t}}},r.exec=function(e,t,n){for(var i=t,o=0,u=n.length;o<u;o++)if(i=e(i,n[o],o),r.isTransformerResult(i)){i=i.__value;break}return i}},function(e,r,t){"use strict";var n=t(13),i=n.map(function(e){return e});r.aggregateBy=function(e,r,t){void 0===r&&(r=[]),void 0===t&&(t=i);var o={};if(!r.length)return o;var u=n.exec(t(n.aggregatesCombinator(r)),o,e);return n.expandAggregates(u)}},function(e,r,t){"use strict";var n=t(8),i=t(2),o=t(1),u=t(16),s={and:" && ",or:" || "},a=function(e,r){if(i.isFunction(e)){var t="__f["+r.length+"](d)";return[t,r.concat([e])]}return[n.expr(e),r]},c=function(e,r,t){if(i.isFunction(e.operator)){var n="__o["+r.length+"]("+t+", "+u.operators.quote(e.value)+")";return[n,r.concat([e.operator])]}var o=!i.isPresent(e.ignoreCase)||e.ignoreCase;return[u.operators[e.operator||"eq"](t,e.value,o),r]},f=function(e,r,t,n){var i=a(e.field,n),o=i[0],u=i[1],s=c(e,t,o),f=s[0],l=s[1];return{expression:r.concat([f]),fields:u,operators:l}},l=function(){return{compositeFilterExpression:function(e,r,t,n){var i=l.filterExpr(e),o=i.expression.replace(/__o\[(\d+)\]/g,function(e,r){return"__o["+(t.length+ +r)+"]"}).replace(/__f\[(\d+)\]/g,function(e,r){return"__f["+(n.length+ +r)+"]"});return{expression:r.concat([o]),fields:n.concat(i.fields),operators:t.concat(i.operators)}},createExpression:function(e,r){return o.isCompositeFilterDescriptor(r)?l.compositeFilterExpression(r,e.expression,e.operators,e.fields):f(r,e.expression,e.operators,e.fields)},filterExpr:function(e){for(var r=e.filters,t={expression:[],fields:[],operators:[]},n=0,i=r.length;n<i;n++)t=l.createExpression(t,r[n]);return{expression:"("+t.expression.join(s[e.logic])+")",fields:t.fields,operators:t.operators}}}}();r.filterExpr=l.filterExpr,r.compileFilter=function(e){if(!e||0===e.filters.length)return function(){return!0};var t=r.filterExpr(e),n=new Function("d, __f, __o","return "+t.expression),i=t.fields.length||t.operators.length;return i?function(e){return n(e,t.fields,t.operators)}:n},r.filterBy=function(e,t){return!i.isPresent(t)||o.isCompositeFilterDescriptor(t)&&0===t.filters.length?e:e.filter(r.compileFilter(u.normalizeFilters(t)))}},function(e,r,t){"use strict";var n=t(2),i=t(1),o=/^\/Date\((.*?)\)\/$/,u=/(\r+|\n+)/g,s=/(?=['\\])/g,a=function(e){return{"!=":"neq","<":"lt","<=":"lte","==":"eq",">":"gt",">=":"gte",equal:"eq",equals:"eq",equalto:"eq",ge:"gte",greater:"gt",greaterthan:"gt",greaterthanequal:"gte",isempty:"isempty",isequalto:"eq",isgreaterthan:"gt",isgreaterthanorequalto:"gte",islessthan:"lt",islessthanorequalto:"lte",isnotempty:"isnotempty",isnotequalto:"neq",isnull:"isnull",le:"lte",less:"lt",lessthan:"lt",lessthanequal:"lte",ne:"neq",notequal:"neq",notequals:"neq",notequalto:"neq",notsubstringof:"doesnotcontain"}[e.toLowerCase()]||e},c=function(e){var r=e.filters||[];r.forEach(function(e){!i.isCompositeFilterDescriptor(e)&&n.isString(e.operator)&&(e.operator=a(e.operator)),i.isCompositeFilterDescriptor(e)&&c(e)})},f=function(e){return i.isCompositeFilterDescriptor(e)?e:{filters:n.isArray(e)?e:[e],logic:"and"}};r.normalizeFilters=function(e){return n.isPresent(e)&&(e=f(e),c(e)),e},r.operators=function(){var e=function(e){return e.replace(s,"\\").replace(u,"")},r=function(r,t,i,u){if(null!=i){if(n.isString(i)){i=e(i);var s=o.exec(i);s?i=new Date(+s[1]):u?(i="'"+i.toLowerCase()+"'",t="(("+t+" || '')+'').toLowerCase()"):i="'"+i+"'"}i.getTime&&(t="("+t+" && "+t+".getTime?"+t+".getTime():"+t+")",i=i.getTime())}return t+" "+r+" "+i},t=function(r,t,n,i){return i&&(t="("+t+" || '').toLowerCase()",n&&(n=n.toLowerCase())),n&&(n=e(n)),r(t,n)};return{contains:function(e,r,n){return t(function(e,r){return e+".indexOf('"+r+"') >= 0"},e,r,n)},doesnotcontain:function(e,r,n){return t(function(e,r){return e+".indexOf('"+r+"') == -1"},e,r,n)},doesnotendwith:function(e,r,n){return t(function(e,r){return e+".indexOf('"+r+"', "+e+".length - "+(r||"").length+") < 0"},e,r,n)},doesnotstartwith:function(e,r,n){return t(function(e,r){return e+".lastIndexOf('"+r+"', 0) == -1"},e,r,n)},endswith:function(e,r,n){return t(function(e,r){return e+".indexOf('"+r+"', "+e+".length - "+(r||"").length+") >= 0"},e,r,n)},eq:function(e,t,n){return r("==",e,t,n)},gt:function(e,t,n){return r(">",e,t,n)},gte:function(e,t,n){return r(">=",e,t,n)},isempty:function(e){return e+" === ''"},isnotempty:function(e){return e+" !== ''"},isnotnull:function(e){return"("+e+" !== null && "+e+" !== undefined)"},isnull:function(e){return"("+e+" === null || "+e+" === undefined)"},lt:function(e,t,n){return r("<",e,t,n)},lte:function(e,t,n){return r("<=",e,t,n)},neq:function(e,t,n){return r("!=",e,t,n)},quote:function(r){return r&&r.getTime?"new Date("+r.getTime()+")":n.isString(r)?"'"+e(r)+"'":""+r},startswith:function(e,r,n){return t(function(e,r){return e+".lastIndexOf('"+r+"', 0) == 0"},e,r,n)}}}()}])});